# 카드 게임 도메인

## 카드 게임 (CardGame)

### 상태

- `deck`: `Deck` 게임에 사용되는 카드 덱
- `playerHands`: `PlayerHands` 플레이어들의 카드 핸드 관리
- `round`: `CardGameRound` 현재 라운드
- `state`: `CardGameState` 현재 게임 상태

### 행위

- `getResult()`: 게임 결과를 반환한다.
- `getMiniGameType()`: 미니게임 타입을 반환한다.
- `startGame(List<Player>)`: 게임을 시작한다.
- `getScores()`: 플레이어별 점수를 반환한다.
- `startRound()`: 새 라운드를 시작한다.
- `updateDescription()`: 설명 상태로 변경한다.
- `startPlay()`: 게임 플레이를 시작한다.
- `selectCard(Player, Integer)`: 플레이어가 카드를 선택한다.
- `isFinishedThisRound()`: 현재 라운드가 끝났는지 확인한다.
- `findPlayerByName(PlayerName)`: 이름으로 플레이어를 찾는다.
- `assignRandomCardsToUnselectedPlayers()`: 선택하지 않은 플레이어들에게 랜덤 카드 배정
- `findCardOwnerInCurrentRound(Card)`: 현재 라운드에서 특정 카드의 소유자를 찾는다.
- `changeScoreBoardState()`: 점수판 상태로 변경
- `changeDoneState()`: 완료 상태로 변경

### 규칙

- 카드 선택은 게임이 PLAYING 상태일 때만 가능하다.
- 각 플레이어는 라운드마다 하나의 카드를 선택한다.

## 플레이어 핸드들 (PlayerHands)

### 상태

- `playerHands`: `Map<Player, CardHand>` 플레이어별 카드 핸드

### 행위

- `put(Player, Card)`: 플레이어에게 카드를 배정한다.
- `totalHandSize()`: 모든 플레이어의 총 카드 수를 반환한다.
- `playerCount()`: 플레이어 수를 반환한다.
- `isRoundFinished()`: 라운드가 끝났는지 확인한다.
- `findPlayerByName(PlayerName)`: 이름으로 플레이어를 찾는다.
- `scoreByPlayer()`: 플레이어별 점수를 계산한다.
- `getUnselectedPlayers(CardGameRound)`: 특정 라운드에서 카드를 선택하지 않은 플레이어들을 반환한다.
- `findCardOwner(Card, CardGameRound)`: 특정 라운드에서 카드의 소유자를 찾는다.

## 카드 핸드 (CardHand)

### 상태

- `hand`: `List<Card>` 플레이어가 보유한 카드들

### 행위

- `calculateCardGameScore()`: 카드 게임 점수를 계산한다.
- `put(Card)`: 카드를 추가한다.
- `size()`: 카드 수를 반환한다.
- `getCard(int)`: 특정 인덱스의 카드를 반환한다.
- `isSelected(CardGameRound)`: 특정 라운드에서 카드를 선택했는지 확인한다.
- `isAssign(Card, CardGameRound)`: 특정 라운드에서 특정 카드가 배정되었는지 확인한다.

## 덱 (Deck)

### 상태

- `cards`: `List<Card>` 전체 카드 목록
- `pickedCards`: `List<Card>` 이미 선택된 카드들

### 행위

- `shuffle()`: 카드를 섞고 선택된 카드 목록을 초기화한다.
- `pick(int)`: 특정 인덱스의 카드를 선택한다.
- `pickRandom()`: 랜덤하게 카드를 선택한다.
- `size()`: 덱의 크기를 반환한다.

### 규칙

- 이미 선택된 카드는 다시 선택할 수 없다.

## 카드 게임 라운드 (CardGameRound)

_Enum_

### 상수

- `READY`: 준비 상태
- `FIRST`: 첫 번째 라운드
- `SECOND`: 두 번째 라운드
- `END`: 게임 종료

### 행위

- `next()`: 다음 라운드를 반환한다.
- `toInteger()`: 라운드를 정수로 변환한다.

### 규칙

- 마지막 라운드에서는 next()를 호출할 수 없다.

## 카드 게임 상태 (CardGameState)

_Enum_

### 상수

- `READY`: 준비 상태
- `LOADING`: 로딩 상태
- `DESCRIPTION`: 설명 상태
- `PLAYING`: 플레이 상태
- `SCORE_BOARD`: 점수판 상태
- `DONE`: 완료 상태

### 상태

- `duration`: `int` 각 상태의 지속 시간(밀리초)

## 카드 (Card)

_Abstract Class_

### 상태

- `type`: `CardType` 카드 타입
- `value`: `int` 카드 값

## 카드 타입 (CardType)

_Enum_

### 상수

- `ADDITION`: 덧셈 카드
- `MULTIPLIER`: 곱셈 카드

## 덧셈 카드 (AdditionCard)

_extends Card_

### 값

- `40`, `35`, `30`, `25`, `20`, `15`, `10`, `5`, `0`, `-5`, `-10`, `-15`, `-20`, `-25`, `-30`, `-35`, `-40`

## 곱셈 카드 (MultiplierCard)

_extends Card_

### 값

- `4`, `2`, `-1`

## 덧셈 카드들 (AdditionCards)

### 상태

- `cards`: `List<Card>` 모든 덧셈 카드들

### 행위

- `pickCards(int)`: 지정된 수만큼 덧셈 카드를 랜덤하게 선택한다.

## 곱셈 카드들 (MultiplierCards)

### 상태

- `cards`: `List<Card>` 모든 곱셈 카드들

### 행위

- `pickCards(int)`: 지정된 수만큼 곱셈 카드를 랜덤하게 선택한다.

## 카드 게임 점수 (CardGameScore)

_extends MiniGameScore_

### 상태

- `addition`: `int` 덧셈 점수
- `multiplier`: `int` 곱셈 점수

### 행위

- `getValue()`: 최종 점수를 계산한다. (addition * multiplier)

## 카드 덱 생성기 (CardGameDeckGenerator)

_Interface_

### 행위

- `generate(int, int)`: `Deck`를 생성하여 반환한다.

## 랜덤 카드 덱 생성기 (CardGameRandomDeckGenerator)

_implements CardGameDeckGenerator_

### 행위

- `generate(int, int)`: 덧셈 카드와 곱셈 카드를 조합해서 랜덤 덱을 생성한다.

## 카드 게임 태스크 실행기 (CardGameTaskExecutorsV2)

### 상태

- `roomTaskExecutorMap`: `Map<JoinCode, MiniGameTaskManager<CardGameTaskType>>` 방별 태스크 실행기 매핑

### 행위

- `put(JoinCode, MiniGameTaskManager<CardGameTaskType>)`: 태스크 실행기를 등록한다.
- `get(JoinCode)`: 특정 방의 태스크 실행기를 반환한다.
- `cancelPlaying(JoinCode, CardGameTaskType)`: 진행중인 태스크를 취소한다.