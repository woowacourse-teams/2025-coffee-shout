## 시나리오 정리

1. 호스트가 방을 만든다. (닉네임, 메뉴 필요)

2. 게스트가 초대코드로 방을 들어간다. (닉네임, 메뉴 필요)
    - 닉네임 입력시 중복 여부 체크
    - 방에 인원이 추가될때 마다 룰렛의 확률이 1/N로 조정된다.
    - 최대 인원은 9명이다.

3. 참가자 탭을 클릭하면 참가자들의 정보가 표시된다. (메뉴, 이름, 인원 수)

4. 미니게임 탭을 클릭하면 미니게임 종류가 표시된다.
    - 호스트가 미니게임을 선택한다. (최소 1개, 최대 5개)

5. 룰렛 탭을 클릭하면 각 사용자별 확률에 맞게 룰렛이 표시된다.

6. 호스트가 게임시작 버튼을 클릭하면 미니게임이 진행된다.
    - 한 번한 미니게임은 다시 할 수 없다.

7. 미니게임이 종료되면 해당 미니게임의 결과를 표시한다.
    - 미니게임 결과를 통해 룰렛의 확률이 조정된다.

8. 룰렛 현황 보러가기를 클릭하면, 룰렛의 현황을 표시한다.
    - 더 플레이할 미니게임이 남아있다면, 시작할 수 있다.
    - 만약 플레이할 미니게임이 없다면, 룰렛을 돌릴 수 있다.

9. 룰렛의 당첨자를 계산한다.

10. 룰렛의 결과가 화면에 표시된다.(당첨자, 주문 리스트)

## 플레이어 이름 (PlayerName)

### 상태

- `value`: `String` 플레이어 이름

### 규칙

- 이름은 공백일 수 없다.
- 이름은 10자 이하여야 한다.

## 플레이어 (Player)

### 상태

- `name`: `PlayerName` 플레이어 이름
- `menu`: `Menu` 메뉴

### 행위

- `selectMenu(menu)`: 메뉴를 선택
- `sameName(PlayerName)`: 같은 이름인지 확인

### 규칙

- 하나의 방에서 이름은 중복될 수 없다.
- 메뉴는 필수이다.

## 플레이어들 (Players)

### 상태

- `players`: `List<Player>` 플레이어 목록

### 행위

- `join(Player)`: 플레이어를 방에 추가한다.
- `notExistPlayerName(PlayerName)`: 플레이어 이름이 중복되지 않는지 확인한다.
- `hasEnoughPlayers(int, int)`: 최소/최대 인원 범위에 맞는지 확인한다.
- `getPlayer(PlayerName)`: 특정 이름의 플레이어를 찾는다.
- `getPlayerCount()`: 플레이어 수를 반환한다.

## 방 (Room)

### 상태

- `joinCode`: `JoinCode` 초대 코드
- `host`: `Player` 방장
- `players`: `Players` 방에 참여한 플레이어들
- `roulette`: `Roulette` 룰렛
- `miniGames`: `List<Playable>` 방에서 플레이할 미니게임들
- `roomState`: `RoomState` 방의 상태 (준비, 플레이, 종료)

### 행위

- `joinGuest(PlayerName, Menu)`: 게스트가 방에 참가한다.
- `addMiniGame(PlayerName, Playable)`: 미니게임을 추가한다.
- `removeMiniGame(PlayerName, Playable)`: 미니게임을 제거한다.
- `startRoulette()`: 룰렛을 돌린다.
- `playMiniGame(Integer)`: 특정 인덱스의 미니게임을 실행한다.
- `findPlayer(PlayerName)`: 플레이어를 찾는다.

### 규칙

- `roomState`가 `READY`일 때만 사용자가 들어오고, 메뉴 선택이 가능하다.
- 미니게임은 5개 이하여야 한다.
- 플레이어가 2인 이상이어야 게임을 시작할 수 있다.
- 플레이어는 최대 9명 접속할 수 있다.
- 플레이어들끼리 이름은 같을 수가 없다.
- 호스트만 미니게임을 추가/제거할 수 있다.

## 룰렛 (Roulette)

### 상태

- `randomPicker`: `RandomPicker` 랜덤 선택기
- `playerProbabilities`: `Map<Player, Probability>` 플레이어별 룰렛 당첨 확률

### 행위

- `spin()`: 룰렛을 돌려서 당첨자를 선택한다. (`Player`를 반환한다.)
- `join(Player)`: 새로운 플레이어를 추가하고 확률을 재분배한다.
- `adjustProbabilities(MiniGameResult, ProbabilityCalculator)`: 미니게임 결과에 따라 플레이어의 당첨 확률 조정
- `getProbability(Player)`: 특정 플레이어의 확률을 가져온다.
- `getProbabilities()`: 모든 플레이어의 확률을 가져온다.

### 규칙

- 모든 플레이어의 확률의 합은 1이어야 한다.
- spin을 하면 플레이어별 확률에 기반해서 winner를 랜덤하게 선정한다.

## 확률 (Probability)

### 상태

- `value`: `Integer` 확률 값 (0 ~ 10000 사이의 정수)

### 행위

- `plus(Probability)`: 확률을 더한다.
- `minus(Probability)`: 확률을 뺀다.
- `divide(int)`: 확률을 나눈다.
- `multiple(int)`: 확률을 곱한다.
- `adjust(MiniGameResultType, Probability)`: 미니게임 결과 타입에 따라 확률을 조정한다.

### 규칙

- `value`는 0에서 10000 사이의 값을 가진다. (확률의 소수점 두 자리를 정수로 표현)

## 확률 계산기 (ProbabilityCalculator)

### 행위

- `calculateAdjustProbability(int, int)`: 플레이어 수와 순위를 기반으로 조정할 확률을 계산한다.

## 룰렛 범위들 (RouletteRanges)

### 상태

- 플레이어별 확률을 기반으로 한 범위 정보

### 행위

- `pickPlayer(int)`: 주어진 숫자에 해당하는 플레이어를 선택한다.
- `endValue()`: 전체 범위의 끝 값을 반환한다.

## 랜덤 선택기 (RandomPicker)

_Interface_

### 행위

- `nextInt(int, int)`: 주어진 범위에서 랜덤 정수를 생성한다.

## 방 상태(RoomState)

_Enum_

### 상수

- `READY`: 준비 중
- `PLAYING`: 게임 중
- `DONE`: 종료

## 초대코드 (JoinCode)

### 상태

- `value`: `String` 초대 코드 값

### 행위

- `generate()` 랜덤 초대 코드를 생성한다.

### 규칙

- 초대 코드는 5자리 랜덤 문자열이다.
- 0, 1, I, O 는 포함하지 않는다.

## 메뉴 (Menu)

### 상태

- `id`: `Long` 메뉴 id
- `name`: `String` 메뉴 이름
- `image`: `String` 메뉴 이미지

### 행위

### 규칙

- 메뉴의 이름은 중복될 수 없다.
- 메뉴 이미지는 uri여야 한다.(uri 규칙 추종)
- 메뉴 이름은 필수
- 이미지는 필수(null이라면 기본 이미지)

## 미니게임 타입 (MiniGameType)

_Enum_
> 미니게임을 나타내는 Enum. 실제 게임 로직은 `Playable` 인터페이스와 구현체에 있다.

### 상수

- `CARD_GAME`: 카드 게임

## 플레이 가능한 게임 (Playable)

_Interface_
> 미니게임 로직을 정의하는 인터페이스

### 행위

- `start()`: 게임을 시작한다.
- `getResult()`: 게임 결과를 반환한다. (`MiniGameResult` 반환)
- `getMiniGameType()`: 미니게임 타입을 반환한다.
- `assignPlayers(Players)`: 게임에 플레이어들을 할당한다.

## 미니게임 결과 (MiniGameResult)

### 상태

- `rank`: `Map<Player, Integer>` 플레이어별 순위

### 행위

- `getPlayerRank(Player)`: 특정 플레이어의 순위를 가져온다.
- `setRank(Integer, Player)`: 플레이어의 순위를 설정한다.

## 미니게임 결과 타입 (MiniGameResultType)

_Enum_

### 상수

- `WINNER`: 승자
- `LOSER`: 패자
- `UNDECIDED`: 무승부

### 행위

- `of(int, int)`: 전체 플레이어 수와 순위를 기반으로 결과 타입을 반환한다.

# 카드 게임 도메인

## 카드 게임 (CardGame)

> `Playable` 인터페이스의 구현체. 여러 라운드에 걸쳐 카드를 선택하고 점수를 계산한다.

### 상태

- `playerCards`: `Map<Player, List<Card>>` 플레이어별 선택한 카드들
- `cardGameDeckGenerator`: `CardGameDeckGenerator` 카드 덱 생성 전략
- `cards`: `List<Card>` 게임에 사용되는 카드 덱
- `round`: `CardGameRound` 현재 라운드

### 행위

- `start()`: 카드 게임을 시작한다. (카드를 섞는다)
- `selectCard(Player, Integer)`: 플레이어가 카드를 선택한다.
- `calculateScores()`: 최종 점수를 계산한다.
- `nextRound()`: 다음 라운드로 진행한다.
- `shuffle()`: 카드를 섞는다.
- `findPlayerByName(String)`: 이름으로 플레이어를 찾는다.
- `isFirstRoundFinished()`: 첫 번째 라운드가 끝났는지 확인한다.
- `isSecondRoundFinished()`: 두 번째 라운드가 끝났는지 확인한다.

### 규칙

- 각 플레이어는 라운드마다 하나의 카드를 선택한다.
- 총 2라운드를 진행한다.

## 카드 게임 라운드 (CardGameRound)

_Enum_

### 상수

- `FIRST`: 첫 번째 라운드
- `SECOND`: 두 번째 라운드
- `END`: 게임 종료

### 상태

- `value`: `Integer` 라운드 값

### 행위

- `next()`: 다음 라운드를 반환한다.

## 카드 (Card)

_Interface_
> 게임에 사용되는 카드를 나타내는 인터페이스

### 행위

- `getType()`: 카드 타입을 반환한다.
- `value()`: 카드 값을 반환한다.

## 카드 타입 (CardType)

_Enum_

### 상수

- `ADDITION`: 덧셈 카드
- `MULTIPLIER`: 곱셈 카드

## 덧셈 카드 (AdditionCard)

> `Card` 인터페이스의 구현체. 점수를 더하거나 뺀다.

### 상태

- `type`: `CardType.ADDITION`
- `value`: `Integer` 더할 점수

## 곱셈 카드 (MultiplierCard)

> `Card` 인터페이스의 구현체. 점수를 곱한다.

### 상태

- `type`: `CardType.MULTIPLIER`
- `value`: `Integer` 곱할 값

## 카드 게임 점수 (CardGameScore)

### 상태

- `value`: `Integer` 점수 합

### 행위

- `addCard(Card)`: 카드의 효과를 점수에 적용한다.
- `compareTo(CardGameScore)`: 다른 점수와 비교한다.

### 규칙

- 처음 값은 0이다.
- ADDITION 카드는 값을 더하거나 뺀다.
- MULTIPLIER 카드는 현재 점수에 곱한다.

## 카드 덱 생성기 (CardGameDeckGenerator)

_Interface_
> 카드 게임에 사용될 덱을 생성하는 전략 인터페이스

### 행위

- `spreadCards()`: `List<Card>`를 생성하여 반환한다.

## 랜덤 카드 덱 생성기 (CardGameRandomDeckGenerator)

> `CardGameDeckGenerator`의 구현체. 정해진 규칙에 따라 랜덤하게 카드를 생성한다.

### 행위

- `spreadCards()`: 랜덤하게 카드 덱을 생성한다.
